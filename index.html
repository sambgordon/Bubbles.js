<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
		<link href='style.css' rel='stylesheet' type='text/css'>

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script  src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>


/* ===========================================================

 * ========================================================== */


 	$(document).ready( function() {
 			$("canvas.bubble").responsiveBubbles({
 					windPower: 2,
 					speed: 1,
 					count: 250,
 					size: 20
 				});
 					$(".windPower").on("change", function () {
 							$("canvas.bubble").trigger("responsiveBubbles", ["windPower", parseInt($().val())]);
 					});
 	});
!function($){

  var defaults = {
    speed: 0,
    responsiveHover: true,
    opacity: 1,
    color: "#DC143C",
    hide: false
    };

  $.fn.responsiveBubbles = function(options){
    var settings = $.extend({}, defaults, options),
        el = $(this),
        bubbles = [],
        canvas = el.get(0),
        ctx = canvas.getContext("2d"),
        bubbleCount = settings.count,
        mX = -1100,
        mY = -1100;
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        function init() {
         for (var i = 0; i < bubbleCount; i++) {
             var x = Math.floor(Math.random() * canvas.width),
                 y = Math.floor(Math.random() * canvas.height),
                 size = (Math.random() * 3)  + settings.size,
                 speed = (Math.random() * 1) + settings.speed,
                 opacity = (Math.random() * 0.5) + settings.opacity;


             bubbles.push({
                 speed: speed,
                 velY: speed,
                 velX: 0,
                 x: x,
                 y: y,
                 size: size,
                 stepSize: (Math.random()) / 30,
                 step: 0,
                 angle: 10,
                 opacity: 2
             });
         }




    (function() {
        var requestAnimationFrame = window.requestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
            window.setTimeout(callback, 100 / 60);
        };
        window.requestAnimationFrame = requestAnimationFrame;
    })();

    function snow() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (var i = 0; i < bubbleCount; i++) {
            var bubble = bubbles[i],
                x = mX,
                y = mY,
                minDist = 100,
                x2 = bubble.x,
                y2 = bubble.y;

            var dist = Math.sqrt((x2 - x) * (x2 - x) + (y2 - y) * (y2 - y)),
                dx = x2 - x,
                dy = y2 - y;

            if (dist < minDist) {
                var force = minDist / (dist * dist),
                    xcomp = (x - x2) / dist,
                    ycomp = (y - y2) / dist,
                    deltaV = force / 2;

                bubble.velX -= deltaV * xcomp;
                bubble.velY -= deltaV * ycomp;

            }

						/*else case start */
						else {
                bubble.velX *= .98;
                if (bubble.velY <= bubble.speed) {
                    bubble.velY = bubble.speed
                }

                switch (settings.windPower) {
                  case false:
                    bubble.velX += Math.tan(bubble.step += .95) * bubble.stepSize;
                  break;

                  case 0:
                    bubble.velX += Math.tan(bubble.step += .95) * bubble.stepSize;
                  break;
                  /*--------*/
                  default:
                    bubble.velX += 0.01 + (settings.windPower/1000);
                }




            }
						/* sets color based on regex match of variable s */
            var s = settings.color;
            var patt = /^#([\d-fA-F]{2})([\d-fA-F]{2})([\d-fA-F]{2})/;
            var matches = patt.exec(s);
            var rgb = parseInt(matches[1], 16)+","+parseInt(matches[2], 16)+","+parseInt(matches[3], 16);

						/*define velocity vars for y and x coordinates*/
            bubble.y += bubble.velY;
            bubble.x += bubble.velX;

            if (bubble.y >= canvas.height || bubble.y <= -25) {
                reset(bubble);
            }


            if (bubble.x >= canvas.width || bubble.x <= -25) {
                reset(bubble);
            }
            if (settings.hide == false) {
              ctx.fillStyle = "rgba(" + rgb + "," + bubble.opacity + ")"
              ctx.beginPath();
              ctx.arc(bubble.x, bubble.y, bubble.size, 0, Math.PI * 2);
              ctx.fill();
            } else {

              ctx.drawhide($("img#lis_bubble").get(0), bubble.x, bubble.y, bubble.size * 2, bubble.size * 2);
            }

        }
        requestAnimationFrame(snow);
    };


    function reset(bubble) {
        if (settings.windPower == false || settings.windPower == 0) {
          bubble.x = Math.floor(Math.random() * canvas.width);
          bubble.y = 0;
        } else {
          if (settings.windPower > 0) {
            var xarray = Array(Math.floor(Math.random() * canvas.width), 0);
            var yarray = Array(0, Math.floor(Math.random() * canvas.height))
            var allarray = Array(xarray, yarray)

            var selected_array = allarray[Math.floor(Math.random()*allarray.length)];

             bubble.x = selected_array[0];
             bubble.y = selected_array[1];
          }
        }
    }



      snow();
    }
/*---------------------*/
    if (settings.hide != false) {
      $("<img src='"+settings.hide+"' style='display: none' id='lis_bubble'>").prependTo("body")
    }

    init();



/*---------------------*/

    if (settings.responsiveHover == true) {
      canvas.addEventListener("mousemove", function(e) {
          mX = e.clientX,
          mY = e.clientY
      });
    }
  }
}(window.jQuery);

</script>

</head>
<body>
	<div class="main">
  <canvas width="100%" height="100%" class="bubble"></canvas>
  <div class="wrapper">
	  <div class="main">
	   <div class="header">
        <h1 style="padding-top: 200px; ">
					Responsive Bubbles
					&nbsp;</h1>
        <h2>Semi-random bubble clusters</h2>
				<p> Hover around! <p>
  	  </div>
      </div>
    </div>
  </div>
</div>
</body>

</html>
